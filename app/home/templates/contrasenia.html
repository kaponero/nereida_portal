{% extends "accounts/base.html" %}

{% block title %}Cambiar contraseña{% endblock %}

{% block links %}
<link rel="stylesheet"
      href="{{ url_for('static', filename='asset/css/seguridadstyles.css') }}?v={{ config.APP_VERSION }}">
{% endblock %}

{% block content %}

<div class="seguridad">
    <div class="configuracion">

        <form id="f-psw"
              method="post"
              onsubmit="return verificarPasswords();">

            {{ form.hidden_tag() }}

            <h2>Cambiar contraseña</h2>

            {# Mensajes flash #}
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul>
                {% for category, message in messages %}
                    <li style="color: {{ 'green' if category == 'success' else 'brown' }};">
                        {{ message }}
                    </li>
                {% endfor %}
                </ul>
                <br>
            {% endif %}
            {% endwith %}

            <div id="error_tamanio" style="display:none;">
                <ul>
                    <li style="color:brown;">
                        La contraseña debe tener al menos 8 caracteres
                    </li>
                </ul>
                <br>
            </div>

            {{ form.password(
                class="form-control",
                id="psw",
                placeholder="Contraseña actual",
                autocomplete="current-password",
                required=true
            ) }}
            <ion-icon class="ojo"
                      id="actual"
                      name="eye-outline"
                      aria-label="Mostrar contraseña actual"></ion-icon>

            {{ form.new_password(
                class="form-control",
                id="new_psw",
                placeholder="Nueva contraseña",
                autocomplete="new-password",
                required=true
            ) }}
            <ion-icon class="ojo"
                      id="nueva"
                      name="eye-outline"
                      aria-label="Mostrar nueva contraseña"></ion-icon>

            {{ form.password_confirmation(
                class="form-control",
                id="repite_psw",
                placeholder="Repetir contraseña",
                autocomplete="new-password",
                required=true
            ) }}
            <ion-icon class="ojo"
                      id="repite"
                      name="eye-outline"
                      aria-label="Mostrar confirmación de contraseña"></ion-icon>

            <input type="submit" value="Guardar">
        </form>

    </div>
</div>

{% endblock content %}

{% block javascripts %}

<script type="text/javascript"
        src="{{ url_for('static', filename='asset/js/seguridad.js') }}?v={{ config.APP_VERSION }}">
</script>

<script type="module"
        src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js">
</script>
<script nomodule
        src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js">
</script>

{% endblock javascripts %}
